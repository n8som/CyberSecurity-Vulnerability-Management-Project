# OpenVAS CyberSecurity Vulnerability Management Project

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/8b53c9fa-5c94-47a8-81fc-ac4ecbc73a21)

<h2>Intro</h2>

Welcome to my lab session today where I'm going to be focusing on cybersecurity vulnerability management. Let's take a look at what I'll be doing.

I will be using Microsoft Azure which gives me the platform to perform all my activities.

First, I will set up my Vulnerability Management Scanner by installing OpenVAS from the Azure marketplace. I will use a weak pre-set configuration for my virtual machine (VM) and SSH into it, waiting for the OpenVAS to deploy.

Once deployed, I log into the web app using the provided default credentials, then immediately change the password for security purposes.

I then proceed to create a client virtual machine. This VM is intentionally made vulnerable for these exercises. It's important to set the VM in the same region and virtual network as OpenVAS for compatibility. We install outdated versions of software like Firefox, VLC Player, and Adobe Reader to make it vulnerable.

Once the vulnerable VM is ready, I configure OpenVAS to perform my first unauthenticated scan against it. I create a new target, host, and task for this process. The scan gives me insights into the VM's vulnerabilities.

Afterward, I start preparations for credentialed scans. This involves making configurations within the VM like disabling the Windows Firewall and User Account Control, enabling Remote Registry, and setting a specific Registry Key.

Similarly, configurations for credentialed scans are also made within OpenVAS. I create new credentials and clone the previous target for this purpose.

I execute the credentialed scan against the vulnerable VM using the newly created credentials. This scan takes longer than the previous one but provides a more in-depth analysis of vulnerabilities.

Once I've identified the vulnerabilities, I remediate them by uninstalling the outdated software and restarting the VM.

Finally, I verify our remediations by re-initiating the credentialed scan and observing the results.

This entire process gives me valuable experience in vulnerability management, from creation to remediation. Remember, this lab is intended for educational purposes and it's crucial to always follow ethical practices in cybersecurity. Thanks for joining me and happy learning!

<h2>Step 1: Prepare Vulnerability Management Scanner</h2>

In Microsoft Azure, access the marketplace and search for "OpenVAS secured and supported by HOSSTED". 

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/a54cbef4-6557-4bde-9308-ab539b1194ce)

Click on "Start with a pre-set configuration" and choose the weakest one.

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/f6697cc3-5d70-4253-8bc1-f69db139e4e7)

Proceed through creating a virtual machine process. 

Note: I will need to put the Vulnerability Scanner and VMs in the same region. Also under the Monitoring tab, I disable "boot diagnostics" because I won't need it.

After a couple of minutes, my OpenVAS VM deployed!

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/687ee1dc-693e-420f-8b3f-49f4f99f271a)

After the VM is created, I copy the public IP of the machine from Azure and SSH into it using PowerShell because I am using a Windows machine. MAC users will use Terminal.

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/20daec76-700c-4a53-a93c-2e069a9e9e46)

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/33fc3ce3-942c-49a3-873a-569565591c2a)

This will take a while. Take note of the username and password. 

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/432d8c22-cff7-4455-a6af-ed96b0905d27)

Copy and paste this URL into a new tab and this will bring me to the OpenVAS webserver where I log in and perform vulnerability management.

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/4b6e35ae-683a-4af5-b2d4-9ed48504e3e6)

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/c094c947-aa2c-4bc3-9694-18c679d12b45)

After logging in, I changed the password to something easier to remember for this lab.

<h2>Step 2: Create Client VM and Make it Vulnerable</h2>

Navigate back to the Azure portal and create a new VM. I make sure to create it in the same Resource Group and Region.

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/90f77161-3c09-4e74-afa8-9287d1eaa601)

Under the Networking tab make sure it's in the same Virtual Network "OpenVAS-vnet".

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/02a54955-9a25-4325-91c6-bf3bb2352ef3)

After the VM is created, I ensure I can RDP into the VM using the credentials I created.

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/f0570d35-4507-4825-bbfd-10880ca2592a)

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/1ca20f30-5eb4-463b-b93d-75be896f2df1)

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/e463d0bb-ed4f-4c19-89b3-1d8f5af316eb)

Success!

Next, I make the VM vulnerable by disabling the Windows Firewall and installing old versions of software like Firefox, VLC, and Adobe Reader.

To disable Windows Firewall, navigate to Windows Defender Firewall and Advanced Security. Click on Windows Defender Firewall properties and turn off the Firewall state under the Domain, Private, and Public Profile tabs.

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/8c9078d1-c449-4714-bb5d-3dad86e85508)

Now to install some old software, copy and paste this link, https://drive.google.com/drive/u/2/folders/1n83ilCjZWZulbDdYnUe9wQPK2buY47_U into the browser on the VM. Download and install the software.

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/7f7ea963-2a34-4de4-a2ee-a32b30a1cc5c)

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/7640eb00-7335-47f5-8bed-1b314ee2656a)

After installation, I will restart the VM and leave it for now. 

<h2>Step 3: Configure OpenVAS to Perform First Unauthenticated Scan Against the Vulnerable VM</h2>

Login to the OpenVAS webserver that I accessed earlier. Click Assets -> Hosts -> New Hosts

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/c58b2904-98de-49dc-bfe8-2f8680d3d667)

Add the Client VM's Private IP Address. I got this from the Azure Portal.

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/1d664926-99b5-42b1-9e38-6bd4630f685b)

Create a New Target from the Host and name it "Azure Vulnerable VMs".

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/10ba7ab5-896e-45ba-95b2-26591be21497)

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/81086531-e46c-4eeb-9000-af846f647fad)

Next, Create a new Task. Under the Scans tab click Tasks and the create a new task icon.

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/dba14c37-a6de-4080-b558-af00416cb079)

Name it "Scan - Azure Vulnerable VMs", select Azure VUlnerable VMs from the Scan Targets dropdown, and Save the Task.

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/8133973c-8381-4fdf-b925-1347213efaaa)

Start the "Scan - Azure Vulnerable VMs" Task by clicking on the play button under Actions. This will take a while.

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/a1f956b6-ac5a-459e-8337-ec7eaf306647)

Take note of the Status throughout the scan.

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/5f4fa271-c989-4d82-b086-071e3aed1f3e)

Once the scan is finished, click the date under "Last Report" to see the results. Take note of Tabs, specifically the "Results" tab.

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/9efde266-0da2-4b65-b96f-7d4e0ec27380)

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/7aec663c-846f-4a86-84c0-157892e14652)

Even though I installed super old software, it does not show up here. This is because I'm not running a credentialed scan so the scanner could not discover it. I will configure credential scans next.

You can see more results by clicking the X, a remove filter button.

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/77e5865f-87d2-4d6f-b824-42b093f4cb50)

<h2>Step 4: Make Configurations for Credentialed Scans (Within VM)</h2>

Navigate back to the Windows VM. Disable User Account Control by clicking start and typing "user account control". Then drag the meter down.

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/7cab6cd0-4904-4892-87aa-621dedf9382a)

Next, enable Remote Registry by clicking start and searching for "services.msc". Look for Remote Registry and click it. 

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/fc5ca9dd-eb7c-455a-8e58-fe8bdd65e592)

Change Startup Type to "Automatic" click Apply and then Start.

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/b63812cc-7c45-485b-a476-27cf2d9d3453)

Next, set the Registry Key. 

- First launch the Registry Editor (regedit.exe) in "Run as administrator" mode. 
- Navigate to HKEY_LOCAL_MACHINE hive
- Open SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System key
- Create a new DWORD (32-bit) value with the following properties:  Name: LocalAccountTokenFilterPolicy  Value: 1 (after creating the DWORD, right-click and click Modify to change the value)
- Close Registry Editor  
- Restart the VM

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/27a7ba8f-efc3-4668-8f2d-883a64284eef)

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/925ae4c2-9f68-4205-8f31-e1619bd8e09d)

<h2>Step 5: Make Configurations for Credentialed Scans (OpenVAS)</h2>

Navigate back to the OpenVAS webserver. Click on the Configuration tab -> Credentials -> New Credential

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/55ca3833-777f-4d88-9e38-3802d4424b4a)

Name it "Azure VM Credentials". Change Allow Insecure Use to "Yes". I will enter the username and password I used for the Windows 10 VM.

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/a4e7389f-4a50-4760-b89c-29eb861ab4c0)

Go to Configuration -> Targets -> CLONE the Target I made before (the little sheep icon)

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/7355498b-07ae-46be-b6d7-bc82441492f6)

Edit and Rename it “Azure Vulnerable VMs - Credentialed Scan”. Ensure the Private IP is still accurate. Under "Credentials for authenticated checks" click the SMB dropdown and select "Azure VM Credentials" that I just created. Save it.

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/da16a19d-4719-4b29-8059-2f85d7d1281c)

<h2>Step 6: Execute Credentialed Scan against our Vulnerable Windows VM</h2>

Within OpenVAS, go to Scans -> Tasks

CLONE the "Windows Scan" Task, then Edit it: 

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/a08f0f89-bf2a-4bd8-8fa1-49656e8b5b98)

- Rename the clone to "Scan - Azure Vulnerable VMs - Credentialed"
- Targets: Azure Vulnerable VMs - Credentialed Scan
- and Save

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/74ef93fd-bc57-41d4-99bb-2e1491c050a8)

Click the Play button to launch the new Credentialed Scan and wait for it to finish. This will take longer than last time. 

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/8a0d4bdf-360d-44ea-820f-b90e90116920)

After the credentialed scan finishes, I immediately see the difference in findings.

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/7ab808d7-7123-4417-80fb-78abf7d3c90c)

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/047f6953-c74b-4e0c-93c5-b31f6089a65a)

Remove the filter. Check SMB login under "Results". 

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/0b7e62d8-89d5-46bc-893e-495c99258321)

Further, inspect the individual vulnerabilities and see all the Criticals from the out-of-date Firefox.  

You can see each vulnerability in more detail by clicking on them.

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/d444ab75-a1ea-4058-84a2-9c78529a7898)

<h2>Step 7: Remediate Vulnerabilities</h2>

Navigate back to the Windows 10 Vulnerable VM. Instead of taking the time to update each software, I'm just going to uninstall them. I could automate this process, but since it's just a couple of programs on one VM, I will just do it manually. 

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/424ef6dc-158b-4b57-ab2f-716cf634d333)

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/cf8bd55e-f368-493d-aa1c-024c61db48de)

After uninstalling, restart the VM.

To check if the VM has restarted you can navigate to the Azure portal.

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/d34e3a06-c44d-4b8a-9022-0198b26a2e6c)

Looks like both VMs are up and running.

<h2>Step 8: Verify Remediations</h2>

Navigate back to the OpenVAS webserver and re-initiate the “Scan - Azure Vulnerable VMs - Credentialed” scan and observe the results.

After the scan, I can see that compared to before vulnerabilities went down from the "Trend" column. 

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/1bd87eaf-fcef-43e2-9076-eddfc576acdf)

There are still several vulnerabilities, but I can see that uninstalling the old software cleared all the vulnerabilities they may have created. 

![image](https://github.com/n8som/OpenVAS-CyberSecurity-Vulnerability-Management-Project/assets/110139109/c7f90471-7488-4bb0-a1c5-f81f60e0d858)

I can see that vulnerabilities left are from Microsoft Defender which may be related to disabling the Firewalls on the Client VM. 

<h2>Conclusion</h2>

To sum up this project, this is what I did

- Set up a secure Azure network with an OpenVAS Vulnerability Management Scanner VM.
- Developed a vulnerable Windows 10 VM, featuring outdated software and disabled security controls.
- Performed unauthenticated and credentialed vulnerability scans using OpenVAS
- Analyzed scan results, highlighting the difference between unauthenticated and credentialed scans.
- Remediated identified vulnerabilities, and verified successful remediation through subsequent scans.
- Created a list of remediable vulnerabilities to simulate realistic vulnerability remediation scenarios.
